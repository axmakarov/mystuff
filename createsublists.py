# -*- coding: utf-8 -*-
import requests
import json

CampaignsIDsList = [11471056, 11489193, 11522506, 12123084, 12123154, 10730032, 10804265, 11308633, 11445185, 11454742, 11896487, 12123155, 12129599, 12301058, 12303867, 12303868, 12303869, 12303870, 12550142, 11639726, 11653487, 11654807, 12315952, 10864881, 10864882, 11654563, 11751538, 12452800, 12317100, 12328929, 12386831, 12386835, 12414255, 11430778, 11491439, 11553582, 11554236, 11774413, 11801708, 11502538, 11950280, 10781855, 10784315, 10942083, 11150209, 11698825, 11734145, 11799641, 11845857, 12232980, 10717548, 11513154, 11892014, 12051877, 11435519, 12133675, 12149923, 12149977, 12135965, 11136030, 11469717, 11563561, 11867800, 11956989, 10625756, 10489147, 11584389, 12060513, 12063095, 12219321, 12525318, 11045120, 11384928, 11744551, 11819984, 10807161, 11033504, 11591300, 12438099, 11141128, 11563379, 11626791, 12386783, 12387708, 11626739, 11626125, 11677271, 11677561, 11701213, 11802012, 12280945, 11000999, 11448906, 11813036, 11869821, 12313813, 12315858, 10800855, 11099665, 12133549, 12230855, 12332838, 12328564, 12359701, 12361701, 12361704, 12361705, 12374570, 12479440, 12359898, 12368537, 12372188, 12399397, 12497663, 12519495, 12519496, 12519497, 12372191, 12387720, 12404620, 12411481, 12415746, 12416476, 12416484, 12438130, 12458825, 12495018, 12456418, 12465498, 12478368, 12522539, 12537592, 12538407, 12357814, 12401259, 12442289, 12459346, 12538680, 12546493, 11894512, 11892017, 12051888, 11076391, 12600239, 12519494, 12562597, 12562609, 12576043, 12565894, 12578118, 11304128, 10941928, 11532406, 10966289, 12616363, 12614680, 12615397, 12608688, 12620880, 12566623, 12620245, 12621237, 12648099, 12648877, 12648000, 12649437, 12608092, 11969844, 12688066, 12687973, 12698091, 12695687, 12701099, 12707596, 12644888, 12647177, 12648014, 12648322, 12648598, 12718376, 12718378, 12718381, 12644146, 12722318, 12773100, 12758280, 12758192, 12797950, 12799572, 12798856, 12789095, 12789096, 12789097, 12789099, 12815427, 12772170, 12839621, 12835697, 12837254, 12843851, 12843855, 12843856, 12843858, 12843859, 12839685, 12839699, 12839701, 12839702, 12839718, 12839671, 12839678, 12879876, 12869991, 12871771, 12889492]

# CampaignsIDsList = [12133675, 12149923, 12149977, 12135965, 11136030, 11469717, 11563561, 11867800, 11956989, 10625756, 10489147, 11584389, 12060513, 12063095, 12219321, 12525318, 11045120, 11384928, 11744551, 11819984, 10807161, 11033504, 11591300, 12438099, 11141128, 11563379, 11626791, 12386783, 12387708, 11626739, 11626125, 11677271, 11677561, 11701213, 11802012, 12280945, 11000999, 11448906, 11813036, 11869821, 12313813, 12315858, 10800855, 11099665, 12133549, 12230855, 12332838, 12328564, 12359701]

CampaignsIDsSublists = [CampaignsIDsList[x:x+10] for x in xrange(0, len(CampaignsIDsList), 10)]

with open('D:\\dev-trash\\sublists.txt','w+') as f1:
	print >>f1, CampaignsIDsSublists

method = "GetBanners"
token = "cc8fb959428d401a98ab953b75693f2e"
GetPhrases = "Yes"

f3 = open('D:\\dev-trash\\directbanners.txt', 'w+')

i = 1
for CampaignsIDsSublist in CampaignsIDsSublists:
	print i,'\t',CampaignsIDsSublist
	param = dict([("CampaignIDS",CampaignsIDsSublist),("GetPhrases", GetPhrases)])
	request = dict([("method",method),("token",token),("param",param)])
	r = requests.post('https://api.direct.yandex.ru/live/v4/json/',json.dumps(request))
	with open('D:\\dev-trash\\response{0}.json'.format(str(i)),'w+') as f2:
		print >>f2, r.text.encode('utf-8')
	data = json.loads(unicode(r.text))
	for dataItem in data['data']:
		if 'Phrases' in dataItem:
			for phrase in dataItem['Phrases']:
					print >>f3, '{0}\t{1}\t{2}\t{3}\t{4}\t{5}'.format(dataItem['CampaignID'],dataItem['BannerID'],dataItem['AdGroupName'].encode('utf-8'),phrase['Phrase'].encode('utf-8'),dataItem['Geo'],dataItem['Href'].encode('utf-8'))
		else:
			PhraseNull = 'Null'
			print >>f3, '{0}\t{1}\t{2}\t{3}\t{4}\t{5}'.format(dataItem['CampaignID'],dataItem['BannerID'],dataItem['AdGroupName'].encode('utf-8'),PhraseNull,dataItem['Geo'],dataItem['Href'].encode('utf-8'))
	i += 1

# ,dataItem['BannerID'],dataItem['Geo'],dataItem['Href']